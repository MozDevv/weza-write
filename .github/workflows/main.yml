name: Send Email

on:
  workflow_dispatch

jobs:
  email:
    runs-on: ubuntu-latest
    steps:
      - name: Install msmtp
        run: sudo apt-get install -y msmtp

      - name: Configure msmtp
        run: |
          echo "account default" > ~/.msmtprc
          echo "host smtp.gmail.com" >> ~/.msmtprc
          echo "port 587" >> ~/.msmtprc
          echo "auth on" >> ~/.msmtprc
          echo "user sammymathenge5@gmail.com" >> ~/.msmtprc
          echo "password ${{ secrets.EMAIL_PASSWORD }}" >> ~/.msmtprc
          echo "from sammymathenge5@gmail.com" >> ~/.msmtprc   # âœ… FIX: Add envelope-from address
          echo "tls on" >> ~/.msmtprc
          echo "tls_starttls on" >> ~/.msmtprc
          echo "logfile ~/.msmtp.log" >> ~/.msmtprc
          chmod 600 ~/.msmtprc

      - name: Send Email
        run: |
          echo -e "Subject: GitHub Workflow Notification\nFrom: sammymathenge5@gmail.com\nTo: sammymathenge10@gmail.com\n\nHello!\n\nThis email was sent from your GitHub Actions workflow.\n\nBest regards,\nGitHub Actions Bot" | msmtp --from=sammymathenge5@gmail.com sammymathenge10@gmail.com

      - name: Confirm Email Sent
        run: cat ~/.msmtp.log
